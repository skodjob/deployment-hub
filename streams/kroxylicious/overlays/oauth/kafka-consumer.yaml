---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: whatever
spec:
  template:
    spec:
      containers:
        - name: consumer
          env:
            # Oauth Config
            - name: OAUTH_CLIENT_ID
              value: team-ops-client
            - name: OAUTH_CLIENT_SECRET
              valueFrom:
                secretKeyRef:
                  key: clientSecret
                  name: team-ops-client-oauth
            - name: OAUTH_TOKEN_ENDPOINT_URI
              value: https://keycloak.skodjob.io/realms/skodjob-authz/protocol/openid-connect/token
            - name: TOPIC
              value: payments-oauth
            - name: GROUP_ID
              value: kroxy-oauth-consumer-group
            - name: BOOTSTRAP_SERVERS
              value: kroxy-oauth-vc-bootstrap.streams-kroxy-oauth.svc.cluster.local:9093
            - name: CA_CRT
              value: ${secrets:streams-kroxy-oauth/kroxy-oauth-cert:ca.crt}
            - name: USER_CRT
              value: ${secrets:strimzi-kafka-oauth/team-ops-client:user.crt}
            - name: USER_KEY
              value: ${secrets:strimzi-kafka-oauth/team-ops-client:user.key}
      serviceAccountName: kroxy-oauth-clients-sa